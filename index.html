<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>French Vocabulary Trainer</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; padding: 20px; }
    table { margin: 20px auto; border-collapse: collapse; width: 90%; max-width: 600px; }
    th, td { border: 1px solid #ccc; padding: 10px; text-align: center; }
    button { padding: 8px 12px; margin: 5px; font-size: 14px; }
    .highlight { background: yellow; }
    .nav { margin-bottom: 20px; }
    .nav button { font-size: 16px; padding: 10px 15px; }
  </style>
</head>
<body>
  <h1>French Vocabulary Trainer</h1>
  <div class="nav">
    <button onclick="loadSheet('Sheet1')">Basic Words</button>
    <button onclick="loadSheet('Sheet2')">Common Things</button>
  </div>
  <div>
    <button onclick="speakAll()">üîä Speak All</button>
    <button onclick="togglePause()">
      ‚è∏ Pause / ‚ñ∂ Resume
    </button>
  </div>
  <table id="vocabTable">
    <thead>
      <tr><th>French</th><th>English</th><th>Action</th></tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const sheetId = "1whwTQDubf_im8SBxQGvI3diuAdWKwo5CYZwmpDNobEI"; // your sheet ID
    const apiKey = "AIzaSyDUMMY"; // replace with your API key
    let voices = [];
    let synth = window.speechSynthesis;
    let speaking = false;
    let paused = false;
    let queue = [];

    function loadVoices() {
      voices = synth.getVoices();
    }
    window.speechSynthesis.onvoiceschanged = loadVoices;

    function getVoice(lang) {
      return voices.find(v => v.lang.startsWith(lang)) || voices[0];
    }

    async function loadSheet(sheetName) {
      const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${sheetName}?key=${apiKey}`;
      const res = await fetch(url);
      const data = await res.json();
      const rows = data.values.slice(1); // skip header
      const tbody = document.querySelector("#vocabTable tbody");
      tbody.innerHTML = "";
      rows.forEach((row, i) => {
        let tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${row[0]}</td>
          <td>${row[1]}</td>
          <td><button onclick="speakWord('${row[0]}')">üîä Speak</button></td>
        `;
        tbody.appendChild(tr);
      });
    }

    function speakWord(word) {
      let utter = new SpeechSynthesisUtterance(word);
      utter.voice = getVoice("fr");
      synth.cancel();
      synth.speak(utter);
    }

    async function speakAll() {
      if (speaking) return;
      speaking = true;
      paused = false;
      queue = [];
      let rows = document.querySelectorAll("#vocabTable tbody tr");
      rows.forEach(r => {
        let fr = r.cells[0].innerText;
        let en = r.cells[1].innerText;
        queue.push({ fr, en, row: r });
      });
      playQueue();
    }

    function playQueue() {
      if (!queue.length || paused) {
        speaking = false;
        return;
      }
      let { fr, en, row } = queue.shift();
      highlight(row);
      let u1 = new SpeechSynthesisUtterance(fr);
      u1.voice = getVoice("fr");
      let u2 = new SpeechSynthesisUtterance(en);
      u2.voice = getVoice("en");
      u1.onend = () => setTimeout(() => synth.speak(u2), 1000); // 1s pause
      u2.onend = () => setTimeout(playQueue, 1000);
      synth.speak(u1);
    }

    function highlight(row) {
      document.querySelectorAll("#vocabTable tr").forEach(r => r.classList.remove("highlight"));
      row.classList.add("highlight");
    }

    function togglePause() {
      if (!speaking) return;
      if (!paused) {
        synth.pause();
        paused = true;
      } else {
        synth.resume();
        paused = false;
        playQueue();
      }
    }

    // Load first sheet on start
    loadSheet("Sheet1");
  </script>
</body>
</html>


