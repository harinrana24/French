<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>French Learning App</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; background: #f8f9fa; }
    h1 { color: #333; }
    button { 
      margin: 5px; padding: 10px 15px; border: none; border-radius: 8px; 
      cursor: pointer; font-weight: bold; color: white; 
    }
    .active { box-shadow: 0 0 10px rgba(0,0,0,0.3); }
    .nav { background:#007bff; } 
    .resume { background:#28a745; } 
    .pause { background:#ffc107; color:black; } 
    .stop { background:#dc3545; } 
    .speak { background:#17a2b8; } 
    table { margin: 20px auto; border-collapse: collapse; width: 70%; }
    th, td { border: 1px solid #ddd; padding: 10px; }
    tr.highlight { background: #ffeeba; }
  </style>
</head>
<body>
  <h1>French Vocabulary Trainer</h1>

  <div>
    <button class="nav active" onclick="loadSheet('Sheet1', this)">Vocabulary</button>
    <button class="nav" onclick="loadSheet('Sheet2', this)">Common Things</button>
  </div>

  <div>
    <button class="speak" onclick="speakAll()">üîä Speak All</button>
    <button class="pause" onclick="pauseSpeech()">‚è∏ Pause</button>
    <button class="resume" onclick="resumeSpeech()">‚ñ∂ Resume</button>
    <button class="stop" onclick="stopSpeech()">‚èπ Stop</button>
  </div>

  <table id="vocabTable">
    <thead>
      <tr><th>French</th><th>English</th><th>Action</th></tr>
    </thead>
    <tbody></tbody>
  </table>

<script>
const sheetId = "1whwTQDubf_im8SBxQGvI3diuAdWKwo5CYZwmpDNobEI"; // your sheet
let currentData = [];
let speakingIndex = 0;
let isSpeakingAll = false;

async function loadSheet(sheetName, btn){
  document.querySelectorAll(".nav").forEach(b => b.classList.remove("active"));
  btn.classList.add("active");

  const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=${sheetName}`;
  const res = await fetch(url);
  const text = await res.text();
  const json = JSON.parse(text.substr(47).slice(0,-2));

  currentData = json.table.rows.map(r => ({
    fr: r.c[0]?.v || "", en: r.c[1]?.v || ""
  }));
  renderTable();
}

function renderTable(){
  const tbody = document.querySelector("#vocabTable tbody");
  tbody.innerHTML = "";
  currentData.forEach((row,i)=>{
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${row.fr}</td>
      <td>${row.en}</td>
      <td><button class="speak" onclick="speakRow(${i})">Speak</button></td>`;
    tbody.appendChild(tr);
  });
}

function speakRow(i){
  stopSpeech();
  const row = currentData[i];
  const u = new SpeechSynthesisUtterance(row.fr);
  u.lang = "fr-FR";
  speechSynthesis.speak(u);
}

function speakAll(){
  stopSpeech();
  isSpeakingAll = true;
  speakingIndex = 0;
  speakNext();
}

function speakNext(){
  if(!isSpeakingAll || speakingIndex >= currentData.length) return;
  const row = currentData[speakingIndex];
  const tbody = document.querySelector("#vocabTable tbody").rows;
  [...tbody].forEach(r=>r.classList.remove("highlight"));
  tbody[speakingIndex].classList.add("highlight");

  const uFr = new SpeechSynthesisUtterance(row.fr);
  uFr.lang = "fr-FR";
  uFr.onend = ()=> {
    setTimeout(()=>{
      const uEn = new SpeechSynthesisUtterance(row.en);
      uEn.lang = "en-US";
      uEn.onend = ()=> {
        setTimeout(()=>{
          speakingIndex++;
          speakNext();
        }, 1000); // 1 sec pause
      };
      speechSynthesis.speak(uEn);
    }, 1000); // pause before English
  };
  speechSynthesis.speak(uFr);
}

function pauseSpeech(){ speechSynthesis.pause(); }
function resumeSpeech(){ speechSynthesis.resume(); }
function stopSpeech(){
  isSpeakingAll = false;
  speechSynthesis.cancel();
  document.querySelectorAll("tr").forEach(r=>r.classList.remove("highlight"));
}

// Load Sheet1 by default
loadSheet("Sheet1", document.querySelector(".nav"));
</script>
</body>
</html>

